{"ast":null,"code":"var _jsxFileName = \"/Users/matt/Desktop/dev/React/src/components/Movies.js\";\nimport React, { Component } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch } from '@fortawesome/free-solid-svg-icons';\nimport Header from \"./Header\";\nimport MovieList from \"./MovieList\";\n\nclass Movies extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      filtered: [],\n      movies: [],\n      title: \"Popular Movies\"\n    };\n    this.formatResults = this.formatResults.bind(this);\n    this.search = this.search.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.setRatingColour = this.setRatingColour.bind(this);\n    this.formatDate = this.formatDate.bind(this);\n  }\n\n  setRatingColour(averageRating) {\n    var colour = \"\";\n\n    if (averageRating >= 50 && averageRating < 75) {\n      colour = \"#350095\";\n    } else if (averageRating >= 75) {\n      colour = \"#2FCC5F\";\n    } else {\n      colour = \"#BF004A\";\n    }\n\n    return colour;\n  }\n\n  formatDate(releasedOn) {\n    if (releasedOn !== undefined) {\n      var releasedOn = releasedOn.split(\"-\");\n      var releaseDate = new Date(releasedOn[0], releasedOn[1]);\n      var month = releaseDate.toLocaleString('default', {\n        month: 'long'\n      });\n      var date = releasedOn[0] + \" \" + month;\n    } else {\n      date = \"TBA\";\n    }\n\n    return date;\n  }\n\n  formatResults(results) {\n    var els = results.map(mov => {\n      var movieImage = \"https://image.tmdb.org/t/p/w600_and_h900_bestv2/\" + mov.poster_path;\n      let average = mov.vote_average * 10;\n      var colour = this.setRatingColour(average);\n      var ratingColor = {\n        background: colour\n      };\n      var date = this.formatDate(mov.release_date);\n      let id = \"/movie/\".concat(mov.id);\n      return {\n        title: mov.original_title,\n        date: date,\n        image: movieImage,\n        average: average,\n        link: id,\n        ratingColor: ratingColor\n      };\n    });\n    this.setState({\n      filtered: els\n    });\n  }\n\n  componentDidMount() {\n    fetch(\"https://api.themoviedb.org/3/trending/all/day?api_key=6ed12e064b90ae1290fa326ce9e790ff&language=en-US\").then(res => {\n      return res.json();\n    }).then(data => {\n      this.setState({\n        movies: data.results\n      });\n      this.formatResults(data.results);\n    });\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({\n      filtered: nextProps.items\n    });\n  }\n\n  handleError() {\n    this.props.history.push(\"error/\");\n  }\n\n  handleKeyDown(e) {\n    let heading = document.querySelector(\".CollectionHeading\").firstElementChild;\n    let query = e.target.value;\n\n    if (e.key === 'Enter') {\n      this.search();\n    }\n\n    if (query === \"\") {\n      this.formatResults(this.state.movies);\n      heading.innerText = \"Popular Movies\";\n    }\n  }\n\n  search(e) {\n    let heading = document.querySelector(\".CollectionHeading\").firstElementChild;\n    let query = document.querySelector(\".SearchInput\").value;\n\n    if (query !== \"\") {\n      heading.innerText = query + \" Results:\"; // Keep a reference to the current movies in state\n\n      fetch(\"https://api.themoviedb.org/3/search/movie?api_key=6ed12e064b90ae1290fa326ce9e790ff&language=en-US&&page=1&include_adult=false&query=\".concat(query)).then(res => {\n        return res.json();\n      }).then(data => {\n        let filtered = data.results.filter(function (x) {\n          return x.adult !== undefined;\n        });\n        this.formatResults(filtered);\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Search col-md-8\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(FontAwesomeIcon, {\n      icon: faSearch,\n      onClick: this.search,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    })), React.createElement(\"input\", {\n      type: \"text\",\n      className: \"SearchInput\",\n      placeholder: \"Search\",\n      onKeyUp: this.handleKeyDown,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"col-md-8 mt-0 CollectionHeading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      className: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \"Popular Movies\")), React.createElement(MovieList, {\n      movies: this.state.filtered,\n      title: this.state.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default Movies;","map":{"version":3,"sources":["/Users/matt/Desktop/dev/React/src/components/Movies.js"],"names":["React","Component","FontAwesomeIcon","faSearch","Header","MovieList","Movies","constructor","props","state","filtered","movies","title","formatResults","bind","search","handleKeyDown","setRatingColour","formatDate","averageRating","colour","releasedOn","undefined","split","releaseDate","Date","month","toLocaleString","date","results","els","map","mov","movieImage","poster_path","average","vote_average","ratingColor","background","release_date","id","original_title","image","link","setState","componentDidMount","fetch","then","res","json","data","componentWillReceiveProps","nextProps","items","handleError","history","push","e","heading","document","querySelector","firstElementChild","query","target","value","key","innerText","filter","x","adult","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faSearch } from '@fortawesome/free-solid-svg-icons'\nimport Header from \"./Header\"\nimport MovieList from \"./MovieList\"\n\nclass Movies extends Component {\n  constructor (props){\n  super(props);\n  this.state = {\n    filtered: [],\n      movies: [],\n      title: \"Popular Movies\"\n  };\n    this.formatResults = this.formatResults.bind(this);\n    this.search = this.search.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.setRatingColour = this.setRatingColour.bind(this);\n    this.formatDate = this.formatDate.bind(this);\n}\n\n  setRatingColour(averageRating){\n    var colour = \"\"\n    if(averageRating >= 50 && averageRating < 75){\n      colour = \"#350095\";\n    } else if (averageRating >= 75) {\n      colour = \"#2FCC5F\";\n    } else {\n      colour = \"#BF004A\"\n    }\n    return colour\n  }\n  \n  formatDate(releasedOn){\n    if (releasedOn !== undefined){\n      var releasedOn = releasedOn.split(\"-\")\n      var releaseDate = new Date(releasedOn[0], releasedOn[1])\n      var month = releaseDate.toLocaleString('default', { month: 'long' });\n      var date = releasedOn[0] + \" \" + month\n    } else {\n      date = \"TBA\"\n    }\n    return date\n  }\n\n  formatResults(results) {\n    var els = results.map((mov) => {\n      var movieImage = \"https://image.tmdb.org/t/p/w600_and_h900_bestv2/\" + mov.poster_path;\n\n      \n      let average = mov.vote_average * 10;\n      var colour = this.setRatingColour(average)\n\n      var ratingColor = {\n        background: colour\n      }\n      \n      var date = this.formatDate(mov.release_date)\n      \n      let id = `/movie/${mov.id}`\n      \n      return (\n          {\n            title: mov.original_title,\n            date: date,\n            image: movieImage,\n            average: average,\n            link: id,\n            ratingColor: ratingColor\n          }\n        )\n    });\n    this.setState({ filtered: els })\n  }\n\n  componentDidMount() {\n    fetch(\"https://api.themoviedb.org/3/trending/all/day?api_key=6ed12e064b90ae1290fa326ce9e790ff&language=en-US\")\n    .then(res => {\n      return res.json();\n    })\n    .then( (data) => {\n      this.setState({\n        movies: data.results\n      });\n      this.formatResults(data.results)\n    })\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({\n      filtered: nextProps.items\n    });\n  }\n\n  handleError() {\n    this.props.history.push(`error/`);\n  }\n\n  handleKeyDown(e) {\n    let heading = document.querySelector(\".CollectionHeading\").firstElementChild;\n    let query = e.target.value;\n       if (e.key === 'Enter') {\n         this.search()\n       }\n       if (query === \"\") {\n         this.formatResults(this.state.movies)\n         heading.innerText = \"Popular Movies\"\n       }\n     }\n\n  search(e) {\n    let heading = document.querySelector(\".CollectionHeading\").firstElementChild;\n    let query = document.querySelector(\".SearchInput\").value;\n\n    if (query !== \"\") {\n      heading.innerText = query + \" Results:\";\n      // Keep a reference to the current movies in state\n    fetch(`https://api.themoviedb.org/3/search/movie?api_key=6ed12e064b90ae1290fa326ce9e790ff&language=en-US&&page=1&include_adult=false&query=${query}`)\n      .then(res => {\n        return res.json();\n      })\n      .then( (data) => {\n        let filtered = data.results.filter(function(x){\n          return x.adult !== undefined\n        })\n        this.formatResults(filtered)\n      });\n    }\n  }\n  render() {\n    return(\n      <div>\n        <Header />\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"Search col-md-8\">\n              <span>\n                <FontAwesomeIcon\n                  icon={faSearch}\n                  onClick={this.search}/>\n              </span>\n              <input type=\"text\"\n                className=\"SearchInput\"\n                placeholder=\"Search\"\n                onKeyUp={this.handleKeyDown} />\n              </div>\n            </div>\n            <div className=\"col-md-8 mt-0 CollectionHeading\">\n              <h2 className=\"\">Popular Movies</h2>\n            </div>\n          <MovieList movies={this.state.filtered} \n                     title={this.state.title} />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Movies;\n"]},"metadata":{},"sourceType":"module"}